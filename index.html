<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¼€è´¢é—¨ | Fortune Gate</title>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary-red: #C41E3A;
            --deep-red: #8B0000;
            --gold-light: #FFE4B5;
            --gold: #FFD700;
            --gold-deep: #DAA520;
            --cream: #FFF8F0;
            --white: #FFFFFF;
            --text-dark: #2D1B0E;
            --text-muted: #6B5B4F;
            --shadow-soft: 0 4px 24px rgba(139, 0, 0, 0.15);
            --shadow-medium: 0 8px 40px rgba(139, 0, 0, 0.2);
            --shadow-strong: 0 16px 60px rgba(139, 0, 0, 0.25);
            --radius-sm: 12px;
            --radius-md: 20px;
            --radius-lg: 28px;
            --radius-xl: 40px;
        }

        body {
            font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: linear-gradient(180deg, 
                #C41E3A 0%, 
                #A01830 30%, 
                #8B0020 70%, 
                #5C0015 100%);
            min-height: 100vh;
            color: var(--text-dark);
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 428px;
            margin: 0 auto;
            padding: 20px 16px 32px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            padding: 12px 0 24px;
            color: var(--white);
            position: relative;
        }

        .header-decoration {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
            border-radius: 2px;
            opacity: 0.6;
        }

        .title {
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: 4px;
            margin-bottom: 6px;
            text-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.3),
                0 0 40px rgba(255, 215, 0, 0.3);
            background: linear-gradient(180deg, #FFFFFF 0%, #FFE4B5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 0.85rem;
            opacity: 0.85;
            font-weight: 400;
            letter-spacing: 2px;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-bottom: 8px;
        }

        .card {
            background: linear-gradient(145deg, #FFFFFF 0%, #FFF8F0 100%);
            border-radius: var(--radius-lg);
            padding: 32px 24px 28px;
            box-shadow: 
                var(--shadow-strong),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gold-deep), var(--gold), var(--gold-deep));
        }

        .card-corner {
            position: absolute;
            width: 32px;
            height: 32px;
            opacity: 0.15;
        }

        .card-corner-tl {
            top: 8px;
            left: 8px;
            border-top: 3px solid var(--gold-deep);
            border-left: 3px solid var(--gold-deep);
        }

        .card-corner-tr {
            top: 8px;
            right: 8px;
            border-top: 3px solid var(--gold-deep);
            border-right: 3px solid var(--gold-deep);
        }

        .card-corner-bl {
            bottom: 8px;
            left: 8px;
            border-bottom: 3px solid var(--gold-deep);
            border-left: 3px solid var(--gold-deep);
        }

        .card-corner-br {
            bottom: 8px;
            right: 8px;
            border-bottom: 3px solid var(--gold-deep);
            border-right: 3px solid var(--gold-deep);
        }

        .btn {
            display: block;
            width: 100%;
            padding: 18px 24px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            text-decoration: none;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
        }

        .btn:active::after {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--gold-deep) 0%, var(--gold) 50%, var(--gold-deep) 100%);
            background-size: 200% 200%;
            color: var(--text-dark);
            box-shadow: 
                0 4px 20px rgba(218, 165, 32, 0.4),
                0 1px 0 rgba(255, 255, 255, 0.5) inset;
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .btn-primary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 
                0 8px 30px rgba(218, 165, 32, 0.5),
                0 1px 0 rgba(255, 255, 255, 0.5) inset;
        }

        .btn-primary:active {
            transform: translateY(0) scale(0.98);
        }

        .btn-secondary {
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFE0A0 100%);
            color: var(--text-dark);
            box-shadow: 
                0 2px 12px rgba(0, 0, 0, 0.08),
                0 1px 0 rgba(255, 255, 255, 0.7) inset;
            margin-top: 12px;
        }

        .btn-secondary:hover {
            transform: translateY(-1px);
            background: linear-gradient(145deg, #FFE0A0 0%, var(--gold-light) 100%);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.12),
                0 1px 0 rgba(255, 255, 255, 0.7) inset;
        }

        .btn-secondary:active {
            transform: translateY(0);
        }

        .btn-small {
            padding: 12px 16px;
            font-size: 0.9rem;
            flex: 1;
        }

        .welcome-emoji {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 20px;
            letter-spacing: 8px;
        }

        .welcome-text {
            text-align: center;
            font-size: 1rem;
            line-height: 2;
            color: var(--text-dark);
            margin-bottom: 24px;
            font-weight: 400;
        }

        .welcome-text strong {
            font-weight: 700;
            color: var(--primary-red);
        }

        .daily-wisdom-card {
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFEFD5 100%);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 24px;
            border: 1px solid rgba(218, 165, 32, 0.3);
            box-shadow: 0 4px 16px rgba(218, 165, 32, 0.12);
        }

        .dw-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .dw-title {
            font-weight: 700;
            color: var(--primary-red);
            font-size: 0.95rem;
        }

        .dw-date {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .dw-god {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .dw-god-emoji {
            font-size: 2.5rem;
        }

        .dw-god-name {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .dw-quote {
            font-size: 0.95rem;
            line-height: 1.8;
            color: var(--text-dark);
            margin-bottom: 16px;
            font-weight: 500;
        }

        .dw-actions {
            display: flex;
            gap: 12px;
        }

        .gate-header {
            margin-bottom: 20px;
        }

        .gate-title {
            text-align: center;
            color: var(--white);
            margin-bottom: 16px;
            font-size: 1.35rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            margin-bottom: 24px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gold-deep), var(--gold), var(--gold-deep));
            background-size: 200% 100%;
            border-radius: 4px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            animation: progressShimmer 2s ease-in-out infinite;
            box-shadow: 0 0 12px rgba(255, 215, 0, 0.5);
        }

        @keyframes progressShimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 200% 50%; }
        }

        .result-card {
            text-align: center;
        }

        .card-type {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--deep-red) 100%);
            color: var(--white);
            padding: 10px 28px;
            border-radius: 50px;
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 24px;
            letter-spacing: 1px;
            box-shadow: 
                0 4px 16px rgba(196, 30, 58, 0.3),
                0 1px 0 rgba(255, 255, 255, 0.2) inset;
        }

        .card-title {
            font-size: 1.9rem;
            font-weight: 800;
            color: var(--primary-red);
            margin-bottom: 28px;
            letter-spacing: 2px;
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--deep-red) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section {
            margin-bottom: 28px;
            text-align: left;
        }

        .section-title {
            font-weight: 700;
            color: var(--primary-red);
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.05rem;
            letter-spacing: 0.5px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, var(--gold-deep), var(--gold));
            border-radius: 2px;
        }

        .section-content {
            line-height: 1.9;
            color: var(--text-dark);
            font-size: 0.98rem;
        }

        .warnings-list {
            list-style: none;
            padding: 0;
        }

        .warnings-list li {
            padding: 12px 0 12px 32px;
            position: relative;
            line-height: 1.7;
            color: var(--text-dark);
            border-bottom: 1px dashed rgba(218, 165, 32, 0.2);
        }

        .warnings-list li:last-child {
            border-bottom: none;
        }

        .warnings-list li::before {
            content: "âš¡";
            position: absolute;
            left: 0;
            font-size: 1.1rem;
        }

        .task-box {
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFE0A0 100%);
            padding: 20px 22px;
            border-radius: var(--radius-md);
            border-left: 4px solid var(--gold-deep);
            line-height: 1.8;
            font-weight: 500;
            color: var(--text-dark);
            box-shadow: 0 2px 12px rgba(218, 165, 32, 0.15);
            position: relative;
        }

        .task-box::before {
            content: 'âœ¦';
            position: absolute;
            top: 12px;
            right: 16px;
            font-size: 1.5rem;
            color: var(--gold-deep);
            opacity: 0.5;
        }

        .nav-buttons {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }

        .nav-buttons .btn {
            flex: 1;
            font-size: 0.98rem;
            padding: 16px 16px;
        }

        .welcome-emoji {
            font-size: 4.5rem;
            margin-bottom: 24px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        .welcome-text {
            font-size: 1.1rem;
            line-height: 2;
            margin-bottom: 32px;
            color: var(--text-dark);
            font-weight: 400;
            letter-spacing: 0.3px;
        }

        .welcome-text strong {
            font-weight: 600;
            color: var(--primary-red);
        }

        .daily-wisdom-card {
            background: linear-gradient(135deg, var(--cream) 0%, #FFEFD5 100%);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 24px;
            border: 2px solid var(--gold-light);
        }

        .dw-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .dw-title {
            font-weight: 700;
            font-size: 1.05rem;
            color: var(--primary-red);
        }

        .dw-date {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .dw-god {
            text-align: center;
            margin-bottom: 12px;
        }

        .dw-god-emoji {
            font-size: 2.5rem;
        }

        .dw-god-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-top: 4px;
        }

        .dw-quote {
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-dark);
            text-align: center;
            padding: 16px;
            background: rgba(255, 215, 0, 0.15);
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
        }

        .dw-actions {
            display: flex;
            gap: 12px;
        }

        .btn-small {
            flex: 1;
            padding: 12px 16px;
            font-size: 0.95rem;
        }

        .menu-card {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 18px 20px;
            background: linear-gradient(145deg, var(--cream) 0%, #FFEFD5 100%);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .menu-item::after {
            content: '';
            position: absolute;
            right: 16px;
            width: 8px;
            height: 8px;
            border-top: 2px solid var(--text-muted);
            border-right: 2px solid var(--text-muted);
            transform: rotate(45deg);
            transition: all 0.3s ease;
        }

        .menu-item:hover {
            transform: translateX(6px);
            border-color: rgba(218, 165, 32, 0.4);
            box-shadow: 0 6px 20px rgba(218, 165, 32, 0.2);
            background: linear-gradient(145deg, #FFEFD5 0%, var(--cream) 100%);
        }

        .menu-item:hover::after {
            border-color: var(--gold-deep);
            transform: translateX(4px) rotate(45deg);
        }

        .menu-emoji {
            font-size: 2.2rem;
            margin-right: 16px;
            width: 48px;
            text-align: center;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .menu-text {
            flex: 1;
            font-weight: 600;
            font-size: 1.05rem;
            color: var(--text-dark);
            letter-spacing: 0.3px;
        }

        .footer {
            text-align: center;
            padding: 20px 16px 8px;
            color: rgba(255, 255, 255, 0.75);
            font-size: 0.8rem;
            line-height: 1.8;
            font-weight: 400;
        }

        .hidden {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(24px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .slide-up {
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .treasury-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
        }

        .treasury-item {
            background: linear-gradient(145deg, var(--cream) 0%, #FFEFD5 100%);
            padding: 24px 16px;
            border-radius: var(--radius-md);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .treasury-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 30%, rgba(255, 215, 0, 0.1), transparent 60%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .treasury-item:hover:not(.locked) {
            transform: translateY(-4px) scale(1.02);
            border-color: rgba(218, 165, 32, 0.4);
            box-shadow: 0 8px 24px rgba(218, 165, 32, 0.25);
        }

        .treasury-item:hover:not(.locked)::before {
            opacity: 1;
        }

        .treasury-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
            background: linear-gradient(145deg, #E8E8E8 0%, #D8D8D8 100%);
        }

        .treasury-emoji {
            font-size: 2.8rem;
            margin-bottom: 12px;
            display: block;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .treasury-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-dark);
            letter-spacing: 0.5px;
        }

        .treasury-item.locked .treasury-name {
            color: var(--text-muted);
        }

        .daily-wisdom {
            font-size: 1.25rem;
            font-style: normal;
            line-height: 2;
            color: var(--text-dark);
            padding: 28px 24px;
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFE0A0 100%);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--gold-deep);
            font-weight: 500;
            position: relative;
            box-shadow: 0 4px 16px rgba(218, 165, 32, 0.2);
        }

        .daily-wisdom::before {
            content: '"';
            position: absolute;
            top: 8px;
            left: 16px;
            font-size: 3rem;
            color: var(--gold-deep);
            opacity: 0.25;
            font-family: Georgia, serif;
            line-height: 1;
        }

        .wisdom-god {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--deep-red) 100%);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
        }

        .wisdom-god-emoji {
            font-size: 3.5rem;
            margin-bottom: 8px;
        }

        .wisdom-god-name {
            color: var(--white);
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 2px;
        }

        .wisdom-god-desc {
            color: var(--gold-light);
            font-size: 0.9rem;
            margin-top: 4px;
            opacity: 0.9;
        }

        .wisdom-lucky-time {
            background: var(--cream);
            padding: 16px;
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
            border: 2px dashed var(--gold-deep);
        }

        .wisdom-lucky-title {
            font-weight: 700;
            color: var(--primary-red);
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .wisdom-lucky-content {
            color: var(--text-dark);
            line-height: 1.8;
            font-size: 0.95rem;
        }

        .wisdom-dos {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .wisdom-do-item {
            padding: 16px;
            border-radius: var(--radius-sm);
        }

        .wisdom-do-good {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border: 2px solid #4CAF50;
        }

        .wisdom-do-bad {
            background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%);
            border: 2px solid #F44336;
        }

        .wisdom-do-title {
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 8px;
        }

        .wisdom-do-good .wisdom-do-title {
            color: #2E7D32;
        }

        .wisdom-do-bad .wisdom-do-title {
            color: #C62828;
        }

        .wisdom-do-list {
            font-size: 0.85rem;
            line-height: 1.8;
            color: var(--text-dark);
        }

        #poster-container,
        #wisdom-poster-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(8px);
            animation: fadeInBg 0.3s ease;
        }

        @keyframes fadeInBg {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        #poster {
            background: linear-gradient(180deg, var(--primary-red) 0%, var(--deep-red) 100%);
            padding: 48px 40px;
            max-width: 380px;
            width: 90%;
            text-align: center;
            border-radius: var(--radius-lg);
            box-shadow: 0 24px 80px rgba(0, 0, 0, 0.4);
            position: relative;
        }
        
        #wisdom-poster {
            background: linear-gradient(180deg, var(--primary-red) 0%, var(--deep-red) 100%);
            padding: 32px 24px;
            max-width: 420px;
            width: 92%;
            text-align: center;
            border-radius: var(--radius-lg);
            box-shadow: 0 24px 80px rgba(0, 0, 0, 0.4);
            position: relative;
        }

        #poster::before,
        #wisdom-poster::before {
            content: '';
            position: absolute;
            top: 16px;
            left: 16px;
            right: 16px;
            bottom: 16px;
            border: 2px dashed rgba(255, 215, 0, 0.3);
            border-radius: var(--radius-md);
            pointer-events: none;
        }

        #poster .poster-title,
        #wisdom-poster .poster-title {
            color: var(--gold);
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 24px;
            letter-spacing: 4px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        #poster .poster-content,
        #wisdom-poster .poster-content {
            background: var(--white);
            padding: 32px 28px;
            border-radius: var(--radius-md);
            color: var(--text-dark);
            line-height: 2;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .small-text {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.85);
            margin-top: 20px;
            letter-spacing: 1px;
        }

        .page-indicator {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-bottom: 16px;
        }

        .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .dot.active {
            background: var(--gold);
            width: 20px;
            border-radius: 3px;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .treasury-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .treasury-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-red);
            letter-spacing: 2px;
            margin-bottom: 8px;
        }

        .treasury-header p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .btn-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .game-instruction {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1rem;
            color: var(--text-dark);
            line-height: 1.8;
        }

        .sorting-game .sorting-boxes {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .sorting-game .sorting-box {
            background: linear-gradient(145deg, var(--cream) 0%, #FFEFD5 100%);
            border: 3px dashed var(--gold-deep);
            border-radius: var(--radius-md);
            padding: 16px 12px;
            text-align: center;
            min-height: 100px;
            transition: all 0.3s ease;
        }

        .sorting-game .sorting-box.drag-over {
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFE0A0 100%);
            border-color: var(--primary-red);
            transform: scale(1.05);
        }

        .sorting-game .sorting-box-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary-red);
            margin-bottom: 8px;
        }

        .sorting-game .sorting-box-items {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
            min-height: 40px;
        }

        .sorting-game .sorting-item-small {
            font-size: 1.5rem;
            background: var(--white);
            border-radius: 8px;
            padding: 4px 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .sorting-game .items-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFE0A0 100%);
            border-radius: var(--radius-md);
        }

        .sorting-game .sorting-item {
            font-size: 2.5rem;
            background: var(--white);
            border-radius: var(--radius-sm);
            padding: 12px 16px;
            cursor: grab;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            user-select: none;
        }

        .sorting-game .sorting-item:hover {
            transform: scale(1.1) rotate(-3deg);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .sorting-game .sorting-item:active {
            cursor: grabbing;
        }

        .catch-game .game-area {
            position: relative;
            height: 300px;
            background: linear-gradient(180deg, #FFE4B5 0%, #FFF8F0 100%);
            border-radius: var(--radius-md);
            overflow: hidden;
            margin-bottom: 16px;
        }

        .catch-game .score-display {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-red);
            margin-bottom: 12px;
        }

        .catch-game .catch-target {
            position: absolute;
            font-size: 3rem;
            cursor: pointer;
            animation: popIn 0.3s ease;
            transition: transform 0.1s ease;
        }

        .catch-game .catch-target:hover {
            transform: scale(1.2);
        }

        @keyframes popIn {
            from {
                transform: scale(0);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .catch-game .catch-effect {
            position: absolute;
            font-size: 2rem;
            pointer-events: none;
            animation: catchEffect 0.5s ease forwards;
        }

        @keyframes catchEffect {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(2) translateY(-30px);
                opacity: 0;
            }
        }

        .match-game .match-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .match-game .match-card {
            background: linear-gradient(145deg, var(--cream) 0%, #FFEFD5 100%);
            border-radius: var(--radius-md);
            padding: 16px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .match-game .match-card:hover:not(.matched) {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(218, 165, 32, 0.3);
        }

        .match-game .match-card.selected {
            border-color: var(--primary-red);
            background: linear-gradient(145deg, #FFE8E8 0%, #FFD5D5 100%);
        }

        .match-game .match-card.matched {
            border-color: var(--gold-deep);
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFE0A0 100%);
            opacity: 0.7;
        }

        .match-game .match-card-text {
            font-size: 0.95rem;
            font-weight: 500;
            line-height: 1.5;
        }

        .match-game .match-hint {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 12px;
        }

        .allocate-game .allocate-sliders {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .allocate-game .allocate-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .allocate-game .allocate-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .allocate-game .allocate-label span:first-child {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .allocate-game .allocate-value {
            font-size: 1.2rem;
            color: var(--primary-red);
            font-weight: 700;
        }

        .allocate-game input[type="range"] {
            width: 100%;
            height: 12px;
            border-radius: 6px;
            background: linear-gradient(90deg, var(--gold-deep), var(--gold));
            outline: none;
            -webkit-appearance: none;
        }

        .allocate-game input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--primary-red);
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(196, 30, 58, 0.4);
            transition: all 0.2s ease;
        }

        .allocate-game input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.15);
        }

        .allocate-game .total-display {
            text-align: center;
            padding: 16px;
            background: linear-gradient(145deg, var(--gold-light) 0%, #FFE0A0 100%);
            border-radius: var(--radius-md);
            margin-bottom: 16px;
        }

        .allocate-game .total-display span {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-red);
        }

        .catch-game .score-display {
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-red);
            margin-bottom: 16px;
        }

        .catch-game .game-area {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, var(--cream) 0%, var(--gold-light) 100%);
            border-radius: var(--radius-md);
            position: relative;
            overflow: hidden;
            border: 3px dashed var(--gold-deep);
        }

        .catch-game .catch-target {
            position: absolute;
            transition: transform 0.1s;
            user-select: none;
        }

        .catch-game .catch-target:hover {
            transform: scale(1.2);
        }

        .choice-game .choice-option {
            padding: 16px 20px;
            background: var(--white);
            border: 2px solid var(--gold-light);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-dark);
            transition: all 0.2s ease;
        }

        .choice-game .choice-option:hover {
            background: linear-gradient(135deg, var(--gold-light) 0%, #FFE0A0 100%);
            border-color: var(--gold-deep);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(218, 165, 32, 0.2);
        }

        .choice-game .choice-option:active {
            transform: translateY(0);
        }

        @media (max-width: 375px) {
            .title {
                font-size: 2.2rem;
            }
            .card {
                padding: 28px 20px 24px;
            }
            .welcome-text {
                font-size: 1rem;
            }
        }

        @media (min-width: 768px) {
            .container {
                padding: 32px 20px 40px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-decoration"></div>
            <div class="title">å¼€è´¢é—¨</div>
            <div class="subtitle">Fortune Gate</div>
        </header>
        <div class="main-content">
            <div id="welcome-page" class="fade-in">
                <div class="card">
                    <div class="card-corner card-corner-tl"></div>
                    <div class="card-corner card-corner-tr"></div>
                    <div class="card-corner card-corner-bl"></div>
                    <div class="card-corner card-corner-br"></div>
                    <div class="welcome-emoji">ğŸ§§</div>
                    <div class="welcome-text">
                        å››æ‰‡è´¢é—¨ï¼Œå››é“æœºç¼˜<br>
                        <strong>å¼€å¯è´¢è¿ï¼Œé‡è§æ›´å¥½çš„è‡ªå·±</strong>
                    </div>
                    
                    <div class="daily-wisdom-card" id="welcome-daily-wisdom">
                        <div class="dw-header">
                            <span class="dw-title">âœ¨ ä»Šæ—¥è´¢ç¥å¼€ç¤º</span>
                            <span class="dw-date" id="welcome-wisdom-date"></span>
                        </div>
                        <div class="dw-god" id="welcome-wisdom-god"></div>
                        <div class="dw-quote" id="welcome-wisdom-quote"></div>
                        <div class="dw-actions">
                            <button class="btn btn-secondary btn-small" onclick="showDailyWisdom()">è¯¦æƒ…</button>
                            <button class="btn btn-primary btn-small" onclick="generateWisdomPoster()">ä¿å­˜</button>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="startGame()">å¼€å¯ç¬¬ä¸€æ‰‡è´¢é—¨</button>
                    <button class="btn btn-secondary" onclick="showMenu()">æˆ‘çš„è´¢åº“</button>
                </div>
            </div>
            <div id="menu-page" class="hidden">
                <div class="card">
                    <div class="card-corner card-corner-tl"></div>
                    <div class="card-corner card-corner-tr"></div>
                    <div class="card-corner card-corner-bl"></div>
                    <div class="card-corner card-corner-br"></div>
                    <div class="menu-card">
                        <div class="menu-item" onclick="continueGame()">
                            <span class="menu-emoji">ğŸ®</span>
                            <span class="menu-text">ç»§ç»­é—¯å…³</span>
                        </div>
                        <div class="menu-item" onclick="restartGame()">
                            <span class="menu-emoji">ğŸ”„</span>
                            <span class="menu-text">é‡æ–°é—¯å…³</span>
                        </div>
                        <div class="menu-item" onclick="showTreasury()">
                            <span class="menu-emoji">ğŸ“¦</span>
                            <span class="menu-text">æˆ‘çš„è´¢åº“</span>
                        </div>
                        <div class="menu-item" onclick="showDailyWisdom()">
                            <span class="menu-emoji">âœ¨</span>
                            <span class="menu-text">æ¯æ—¥è´¢ç¥å¼€ç¤º</span>
                        </div>
                        <div class="menu-item" onclick="showWelcome()">
                            <span class="menu-emoji">ğŸ </span>
                            <span class="menu-text">è¿”å›é¦–é¡µ</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="game-page" class="hidden">
                <div class="gate-header">
                    <div class="gate-title" id="gate-title"></div>
                    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
                </div>
                <div class="card fade-in" id="game-card">
                    <div class="card-corner card-corner-tl"></div>
                    <div class="card-corner card-corner-tr"></div>
                    <div class="card-corner card-corner-bl"></div>
                    <div class="card-corner card-corner-br"></div>
                </div>
            </div>
            <div id="result-page" class="hidden">
                <div class="card result-card fade-in" id="result-card">
                    <div class="card-corner card-corner-tl"></div>
                    <div class="card-corner card-corner-tr"></div>
                    <div class="card-corner card-corner-bl"></div>
                    <div class="card-corner card-corner-br"></div>
                </div>
            </div>
            <div id="treasury-page" class="hidden">
                <div class="card">
                    <div class="card-corner card-corner-tl"></div>
                    <div class="card-corner card-corner-tr"></div>
                    <div class="card-corner card-corner-bl"></div>
                    <div class="card-corner card-corner-br"></div>
                    <div class="treasury-header">
                        <h2>ğŸ“¦ æˆ‘çš„è´¢åº“</h2>
                        <p>æ”¶é›†ä½ çš„è´¢ç¥çœŸä¼ </p>
                    </div>
                    <div class="treasury-grid" id="treasury-grid"></div>
                    <button class="btn btn-secondary" style="margin-top: 24px;" onclick="showMenu()">è¿”å›</button>
                </div>
            </div>
            <div id="wisdom-page" class="hidden">
                <div class="card">
                    <div class="card-corner card-corner-tl"></div>
                    <div class="card-corner card-corner-tr"></div>
                    <div class="card-corner card-corner-bl"></div>
                    <div class="card-corner card-corner-br"></div>
                    <div class="treasury-header">
                        <h2>âœ¨ æ¯æ—¥è´¢ç¥å¼€ç¤º</h2>
                        <p id="wisdom-date"></p>
                    </div>
                    <div class="wisdom-god" id="wisdom-god"></div>
                    <div class="wisdom-lucky-time" id="wisdom-lucky-time"></div>
                    <div class="wisdom-dos" id="wisdom-dos"></div>
                    <div class="daily-wisdom" id="daily-wisdom-text"></div>
                    <button class="btn btn-secondary" style="margin-top: 24px;" onclick="showMenu()">è¿”å›</button>
                </div>
            </div>
        </div>
        <div class="footer">
            æœ¬å†…å®¹ä»…ä¸ºä¸­å›½ä¼ ç»Ÿæ­£å‘æ°‘ä¿—æ–‡åŒ–ä¼ æ’­ä¸ç§¯æå¿ƒç†å­¦å¼•å¯¼ï¼Œ<br>
            ä¸æ¶‰åŠå°å»ºè¿·ä¿¡ä¸ç®—å‘½é¢„æµ‹ï¼Œæ‰€æœ‰å†…å®¹å‡ä¸ºæ­£å‘å¿ƒç†æš—ç¤ºï¼Œæ— ä»»ä½•å†³ç­–æŒ‡å¯¼æ„ä¹‰ã€‚
        </div>
    </div>
    <div id="poster-container" class="hidden">
        <div id="poster">
            <div class="poster-title">å¼€è´¢é—¨</div>
            <div class="poster-content" id="poster-content"></div>
            <div style="margin-top: 20px; text-align: center;">
                <img src="https___ewanqian.github.io_Fortune-Gate_.png" alt="æ‰«ç å¼€è´¢é—¨" style="width: 120px; height: 120px; border-radius: 12px; background: white; padding: 8px;">
                <div class="small-text" style="margin-top: 12px;">ğŸ§§ æ‰«ç è§£é”ä½ çš„è´¢æ°”å¯†ç </div>
            </div>
        </div>
    </div>
    <div id="wisdom-poster-container" class="hidden">
        <div id="wisdom-poster">
            <div class="poster-title">æ¯æ—¥è´¢ç¥å¼€ç¤º</div>
            <div class="poster-content" id="wisdom-poster-content"></div>
            <div style="margin-top: 20px; text-align: center;">
                <img src="https___ewanqian.github.io_Fortune-Gate_.png" alt="æ‰«ç å¼€è´¢é—¨" style="width: 120px; height: 120px; border-radius: 12px; background: white; padding: 8px;">
                <div class="small-text" style="margin-top: 12px;">ğŸ§§ æ‰«ç è§£é”ä½ çš„è´¢æ°”å¯†ç </div>
            </div>
        </div>
    </div>
    <script>
        let gameData = {
            currentGate: 1,
            currentGameStep: 0,
            gameResults: {},
            unlockedCards: [],
            dailyWisdomDate: null,
            dailyWisdomIndex: null
        };

        const staticData = {
            gates: [
                {
                    id: 1,
                    name: "å®ˆæ­£é—¨",
                    god: "æ–‡è´¢ç¥æ¯”å¹²",
                    theme: "ç¨³æ‰ç¨³æ‰“èµšæ­£è´¢ï¼Œé¿å‘ä¸è¸©é›·",
                    emoji: "ğŸ†",
                    gameType: "sorting",
                    gameData: {
                        instruction: "åˆ¤æ–­ä¸‹é¢è¿™äº›äº‹ï¼Œå“ªäº›æ˜¯å¯¹ä½ æ±‚è´¢æœ‰åˆ©çš„ï¼Œå“ªäº›æ˜¯è¦é¿å¼€çš„ï¼",
                        categories: [
                            { id: "good", name: "è¦æŠ“ä½", emoji: "âœ…" },
                            { id: "bad", name: "è¦é¿å¼€", emoji: "âŒ" }
                        ],
                        items: [
                            { emoji: "ğŸ’ª", name: "æ·±è€•ä¸»ä¸š", category: "good", weight: 3 },
                            { emoji: "ğŸ“š", name: "å­¦ä¹ æ–°æŠ€èƒ½", category: "good", weight: 3 },
                            { emoji: "ğŸ¤", name: "ç»´æŠ¤äººè„‰", category: "good", weight: 2 },
                            { emoji: "ğŸ²", name: "ç›²ç›®èµŒåš", category: "bad", weight: 3 },
                            { emoji: "ğŸ¦¢", name: "è½»ä¿¡èººèµš", category: "bad", weight: 3 },
                            { emoji: "ğŸ˜´", name: "å·æ‡’æ‘¸é±¼", category: "bad", weight: 2 }
                        ]
                    },
                    cards: {
                        good: { type: "ç¨³æ‰ç¨³æ‰“å‹", title: "æ­£è´¢å¼€æ‚Ÿå¡", heart: "æ­£è´¢ï¼Œæ˜¯ä½ é è‡ªå·±çš„åŒæ‰‹å’Œä¸“ä¸šï¼Œä¸€åˆ†ä¸€åˆ†èµšæ¥çš„é’±ï¼Œæ˜¯ä½ è´¢å¯Œçš„å‹èˆ±çŸ³ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„æ­£è´¢å¯†ç å°±å››ä¸ªå­—ï¼šæ·±è€•å®ˆæ­£ã€‚", warnings: ["ä¸è¦ç›²ç›®è·Ÿé£åšä¸ç†Ÿæ‚‰çš„å‰¯ä¸š", "ä¸è¦ä¸å¥½æ„æ€æ‹’ç»ä¸åˆç†çš„å·¥ä½œ", "ä¸è¦ç›¸ä¿¡èººèµšã€é«˜å›æŠ¥çš„é¬¼è¯", "å®šæœŸå¤ç›˜ï¼Œä½ çš„åŠªåŠ›æ‰ä¼šè¢«çœ‹è§"], task: "è¿™ä¸ªæœˆï¼Œæ‰“ç£¨ä¸€ä¸ªä½ çš„æ ¸å¿ƒä¸“ä¸šæŠ€èƒ½ï¼Œåšä¸€ä¸ªä½œå“é›†/æˆæœæ€»ç»“ã€‚" },
                        warning: { type: "æ½œåŠ›å¾…æŒ–å‹", title: "æ­£è´¢å¼€æ‚Ÿå¡", heart: "æ­£è´¢ï¼Œæ˜¯ä½ é è‡ªå·±çš„åŒæ‰‹å’Œä¸“ä¸šï¼Œä¸€åˆ†ä¸€åˆ†èµšæ¥çš„é’±ï¼Œæ˜¯ä½ è´¢å¯Œçš„å‹èˆ±çŸ³ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„æ­£è´¢å¯†ç å°±å››ä¸ªå­—ï¼šæ·±è€•å®ˆæ­£ã€‚", warnings: ["ä¸è¦ç›²ç›®è·Ÿé£åšä¸ç†Ÿæ‚‰çš„å‰¯ä¸š", "ä¸è¦ä¸å¥½æ„æ€æ‹’ç»ä¸åˆç†çš„å·¥ä½œ", "ä¸è¦ç›¸ä¿¡èººèµšã€é«˜å›æŠ¥çš„é¬¼è¯", "å®šæœŸå¤ç›˜ï¼Œä½ çš„åŠªåŠ›æ‰ä¼šè¢«çœ‹è§"], task: "è¿™ä¸ªæœˆï¼Œæ‰“ç£¨ä¸€ä¸ªä½ çš„æ ¸å¿ƒä¸“ä¸šæŠ€èƒ½ï¼Œåšä¸€ä¸ªä½œå“é›†/æˆæœæ€»ç»“ã€‚" },
                        danger: { type: "é¿å‘é¢„è­¦å‹", title: "æ­£è´¢å¼€æ‚Ÿå¡", heart: "æ­£è´¢ï¼Œæ˜¯ä½ é è‡ªå·±çš„åŒæ‰‹å’Œä¸“ä¸šï¼Œä¸€åˆ†ä¸€åˆ†èµšæ¥çš„é’±ï¼Œæ˜¯ä½ è´¢å¯Œçš„å‹èˆ±çŸ³ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„æ­£è´¢å¯†ç å°±å››ä¸ªå­—ï¼šæ·±è€•å®ˆæ­£ã€‚", warnings: ["ä¸è¦ç›²ç›®è·Ÿé£åšä¸ç†Ÿæ‚‰çš„å‰¯ä¸š", "ä¸è¦ä¸å¥½æ„æ€æ‹’ç»ä¸åˆç†çš„å·¥ä½œ", "ä¸è¦ç›¸ä¿¡èººèµšã€é«˜å›æŠ¥çš„é¬¼è¯", "å®šæœŸå¤ç›˜ï¼Œä½ çš„åŠªåŠ›æ‰ä¼šè¢«çœ‹è§"], task: "è¿™ä¸ªæœˆï¼Œæ‰“ç£¨ä¸€ä¸ªä½ çš„æ ¸å¿ƒä¸“ä¸šæŠ€èƒ½ï¼Œåšä¸€ä¸ªä½œå“é›†/æˆæœæ€»ç»“ã€‚" }
                    }
                },
                {
                    id: 2,
                    name: "æœºé‡é—¨",
                    god: "æ­¦è´¢ç¥å…³å…¬",
                    theme: "æŠ“é£å£ç ´å±€ï¼Œé åˆ›æ„èµšæœºé‡è´¢",
                    emoji: "âš¡",
                    gameType: "catch",
                    gameData: {
                        instruction: "20ç§’å†…ï¼Œç‚¹å‡»å‡ºç°çš„æœºé‡å›¾æ ‡ï¼æŠ“ä½çš„è¶Šå¤šï¼Œæœºé‡è´¢è¶Šæ—ºï¼",
                        duration: 20,
                        targets: [
                            { emoji: "ğŸš€", points: 3, name: "å¤§æœºé‡" },
                            { emoji: "ğŸ’¡", points: 2, name: "çµæ„Ÿ" },
                            { emoji: "ğŸ¤", points: 2, name: "è´µäºº" },
                            { emoji: "â­", points: 1, name: "å°æœºä¼š" },
                            { emoji: "ğŸ¯", points: 3, name: "é£å£" }
                        ],
                        distractor: { emoji: "ğŸ’£", points: -2, name: "é™·é˜±" }
                    },
                    cards: {
                        good: { type: "é£å£æ•æ‰‹å‹", title: "æœºé‡å¼€æ‚Ÿå¡", heart: "æœºé‡è´¢ï¼Œæ˜¯ä½ é çœ¼å…‰ã€åˆ›æ„å’Œèƒ†è¯†ï¼ŒæŠ“ä½æ—¶ä»£çº¢åˆ©èµšæ¥çš„é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„æœºé‡å¯†ç å°±å››ä¸ªå­—ï¼šæ•¢é—¯æ•¢è¯•ã€‚", warnings: ["ä¸è¦å¹¿æ’’ç½‘è¿½æ‰€æœ‰é£å£", "ä¸è¦åªç©ºæƒ³ä¸è½åœ°", "ä¸è¦ä¸€æŠŠæ¢­å“ˆé«˜é£é™©é¡¹ç›®", "ä¸è¦æ€•çŠ¯é”™"], task: "è¿™ä¸ªæœˆï¼ŒæŠŠä½ è„‘å­é‡Œæƒ³äº†å¾ˆä¹…çš„ä¸€ä¸ªå°åˆ›æ„ï¼ŒèŠ±3å¤©æ—¶é—´è½åœ°å‡ºä¸€ä¸ªæœ€å°ç‰ˆæœ¬ã€‚" },
                        warning: { type: "æ½œåŠ›è§‰é†’å‹", title: "æœºé‡å¼€æ‚Ÿå¡", heart: "æœºé‡è´¢ï¼Œæ˜¯ä½ é çœ¼å…‰ã€åˆ›æ„å’Œèƒ†è¯†ï¼ŒæŠ“ä½æ—¶ä»£çº¢åˆ©èµšæ¥çš„é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„æœºé‡å¯†ç å°±å››ä¸ªå­—ï¼šæ•¢é—¯æ•¢è¯•ã€‚", warnings: ["ä¸è¦å¹¿æ’’ç½‘è¿½æ‰€æœ‰é£å£", "ä¸è¦åªç©ºæƒ³ä¸è½åœ°", "ä¸è¦ä¸€æŠŠæ¢­å“ˆé«˜é£é™©é¡¹ç›®", "ä¸è¦æ€•çŠ¯é”™"], task: "è¿™ä¸ªæœˆï¼ŒæŠŠä½ è„‘å­é‡Œæƒ³äº†å¾ˆä¹…çš„ä¸€ä¸ªå°åˆ›æ„ï¼ŒèŠ±3å¤©æ—¶é—´è½åœ°å‡ºä¸€ä¸ªæœ€å°ç‰ˆæœ¬ã€‚" },
                        danger: { type: "é¿å‘é¢„è­¦å‹", title: "æœºé‡å¼€æ‚Ÿå¡", heart: "æœºé‡è´¢ï¼Œæ˜¯ä½ é çœ¼å…‰ã€åˆ›æ„å’Œèƒ†è¯†ï¼ŒæŠ“ä½æ—¶ä»£çº¢åˆ©èµšæ¥çš„é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„æœºé‡å¯†ç å°±å››ä¸ªå­—ï¼šæ•¢é—¯æ•¢è¯•ã€‚", warnings: ["ä¸è¦å¹¿æ’’ç½‘è¿½æ‰€æœ‰é£å£", "ä¸è¦åªç©ºæƒ³ä¸è½åœ°", "ä¸è¦ä¸€æŠŠæ¢­å“ˆé«˜é£é™©é¡¹ç›®", "ä¸è¦æ€•çŠ¯é”™"], task: "è¿™ä¸ªæœˆï¼ŒæŠŠä½ è„‘å­é‡Œæƒ³äº†å¾ˆä¹…çš„ä¸€ä¸ªå°åˆ›æ„ï¼ŒèŠ±3å¤©æ—¶é—´è½åœ°å‡ºä¸€ä¸ªæœ€å°ç‰ˆæœ¬ã€‚" }
                    }
                },
                {
                    id: 3,
                    name: "å–„ç¼˜é—¨",
                    god: "æ–‡è´¢ç¥èŒƒè ¡",
                    theme: "é‡è´µäººç»“å–„ç¼˜ï¼Œé äººè„‰èµšé•¿ä¹…é’±",
                    emoji: "ğŸ¤",
                    gameType: "choice",
                    gameData: {
                        instruction: "å¦‚æœé‡åˆ°è¿™äº›äººï¼Œä½ ä¼šé€‰æ‹©å’Œè°åšæœ‹å‹ï¼Ÿ",
                        questions: [
                            {
                                emoji: "ğŸ‘¥",
                                question: "èšä¼šæ—¶é‡åˆ°ä¸¤ä¸ªäººï¼Œä½ æ›´æ„¿æ„å’Œè°èŠï¼Ÿ",
                                options: [
                                    { text: "A. æ€»æ˜¯è¯´åˆ«äººåè¯çš„äºº", value: "bad" },
                                    { text: "B. çœŸå¿ƒå¤¸ä½ ä¼˜ç‚¹çš„äºº", value: "good" }
                                ]
                            },
                            {
                                emoji: "ğŸ¤",
                                question: "æœ‹å‹æ‰¾ä½ å¸®å¿™ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ",
                                options: [
                                    { text: "A. å…ˆçœ‹å¯¹è‡ªå·±æœ‰æ²¡æœ‰å¥½å¤„", value: "bad" },
                                    { text: "B. èƒ½å¸®å°±å¸®ï¼ŒçœŸå¿ƒç›¸å¾…", value: "good" }
                                ]
                            },
                            {
                                emoji: "ğŸ’°",
                                question: "å’Œæœ‹å‹ä¸€èµ·èµšé’±æ—¶ï¼Œä½ ä¼šï¼Ÿ",
                                options: [
                                    { text: "A. è‡ªå·±å¤šæ‹¿ä¸€ç‚¹", value: "bad" },
                                    { text: "B. å…¬å¹³åˆ†é…ï¼Œäº’åˆ©å…±èµ¢", value: "good" }
                                ]
                            }
                        ]
                    },
                    cards: {
                        good: { type: "è´µäººå¸é“çŸ³å‹", title: "å–„ç¼˜å¼€æ‚Ÿå¡", heart: "å–„ç¼˜è´¢ï¼Œæ˜¯ä½ é äººè„‰ã€å£ç¢‘å’Œè´µäººææºï¼Œèµšæ¥çš„é•¿ä¹…é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„å–„ç¼˜å¯†ç å°±å››ä¸ªå­—ï¼šçœŸå¿ƒæ¢çœŸå¿ƒã€‚", warnings: ["ä¸è¦ä¸ºäº†è¿åˆåˆ«äººæ¶ˆè€—è‡ªå·±", "ä¸è¦åŠŸåˆ©æ€§ç¤¾äº¤", "ä¸è¦ä¸å¥½æ„æ€æ‹’ç»ä¸é è°±çš„åˆä½œ", "ä¸»åŠ¨å¸®åˆ«äººæ­ä¸ªæ¡¥"], task: "è¿™ä¸ªæœˆï¼Œä¸»åŠ¨è”ç³»3ä¸ªä½ è§‰å¾—é è°±ã€åŒé¢‘çš„æœ‹å‹ï¼ŒçœŸå¿ƒé—®é—®å¯¹æ–¹çš„è¿‘å†µã€‚" },
                        warning: { type: "æ½œåŠ›è§‰é†’å‹", title: "å–„ç¼˜å¼€æ‚Ÿå¡", heart: "å–„ç¼˜è´¢ï¼Œæ˜¯ä½ é äººè„‰ã€å£ç¢‘å’Œè´µäººææºï¼Œèµšæ¥çš„é•¿ä¹…é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„å–„ç¼˜å¯†ç å°±å››ä¸ªå­—ï¼šçœŸå¿ƒæ¢çœŸå¿ƒã€‚", warnings: ["ä¸è¦ä¸ºäº†è¿åˆåˆ«äººæ¶ˆè€—è‡ªå·±", "ä¸è¦åŠŸåˆ©æ€§ç¤¾äº¤", "ä¸è¦ä¸å¥½æ„æ€æ‹’ç»ä¸é è°±çš„åˆä½œ", "ä¸»åŠ¨å¸®åˆ«äººæ­ä¸ªæ¡¥"], task: "è¿™ä¸ªæœˆï¼Œä¸»åŠ¨è”ç³»3ä¸ªä½ è§‰å¾—é è°±ã€åŒé¢‘çš„æœ‹å‹ï¼ŒçœŸå¿ƒé—®é—®å¯¹æ–¹çš„è¿‘å†µã€‚" },
                        danger: { type: "é¿å‘é¢„è­¦å‹", title: "å–„ç¼˜å¼€æ‚Ÿå¡", heart: "å–„ç¼˜è´¢ï¼Œæ˜¯ä½ é äººè„‰ã€å£ç¢‘å’Œè´µäººææºï¼Œèµšæ¥çš„é•¿ä¹…é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„å–„ç¼˜å¯†ç å°±å››ä¸ªå­—ï¼šçœŸå¿ƒæ¢çœŸå¿ƒã€‚", warnings: ["ä¸è¦ä¸ºäº†è¿åˆåˆ«äººæ¶ˆè€—è‡ªå·±", "ä¸è¦åŠŸåˆ©æ€§ç¤¾äº¤", "ä¸è¦ä¸å¥½æ„æ€æ‹’ç»ä¸é è°±çš„åˆä½œ", "ä¸»åŠ¨å¸®åˆ«äººæ­ä¸ªæ¡¥"], task: "è¿™ä¸ªæœˆï¼Œä¸»åŠ¨è”ç³»3ä¸ªä½ è§‰å¾—é è°±ã€åŒé¢‘çš„æœ‹å‹ï¼ŒçœŸå¿ƒé—®é—®å¯¹æ–¹çš„è¿‘å†µã€‚" }
                    }
                },
                {
                    id: 4,
                    name: "èšè´¢é—¨",
                    god: "æ­¦è´¢ç¥èµµå…¬æ˜",
                    theme: "ä¼šèµšé’±æ›´ä¼šå®ˆé’±ï¼Œé è§„åˆ’èµšè§„æ¨¡åŒ–çš„é’±",
                    emoji: "ğŸ“Š",
                    gameType: "allocate",
                    gameData: {
                        instruction: "å¦‚æœä½ æœ‰100ä¸‡å…ƒï¼Œä½ ä¼šå¦‚ä½•åˆ†é…ï¼Ÿï¼ˆå‚è€ƒï¼šå‚¨è“„25-45%ã€æŠ•èµ„20-40%ã€æ¶ˆè´¹10-25%ã€å­¦ä¹ 8-15%ä¸ºæœ€ä½³ï¼‰",
                        total: 100,
                        categories: [
                            { id: "saving", name: "å‚¨è“„", emoji: "ğŸ¦", min: 10, max: 60 },
                            { id: "investment", name: "æŠ•èµ„", emoji: "ğŸ“ˆ", min: 10, max: 50 },
                            { id: "consumption", name: "æ¶ˆè´¹", emoji: "ğŸ›’", min: 5, max: 30 },
                            { id: "study", name: "å­¦ä¹ ", emoji: "ğŸ“š", min: 5, max: 20 }
                        ]
                    },
                    cards: {
                        good: { type: "å¤©ç”Ÿèšè´¢å‹", title: "èšè´¢å¼€æ‚Ÿå¡", heart: "èšè´¢ï¼Œä¸æ˜¯ä½ èƒ½èµšå¤šå°‘é’±ï¼Œè€Œæ˜¯ä½ èƒ½ç•™ä¸‹å¤šå°‘é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„èšè´¢å¯†ç å°±å››ä¸ªå­—ï¼šè°‹å®šè€ŒååŠ¨ã€‚", warnings: ["ä¸è¦èµšå¤šå°‘èŠ±å¤šå°‘", "ä¸è¦äº‹å¿…èº¬äº²", "ä¸è¦ç›²ç›®æ‰©å¼ ", "ä¸è¦åªç›¯ç€èµšé’±"], task: "è¿™ä¸ªæœˆï¼Œç»™è‡ªå·±åšä¸€ä»½å…¨å¹´çš„è´¢å¯Œè§„åˆ’å’Œæ”¶æ”¯è¡¨ã€‚" },
                        warning: { type: "æ½œåŠ›è§‰é†’å‹", title: "èšè´¢å¼€æ‚Ÿå¡", heart: "èšè´¢ï¼Œä¸æ˜¯ä½ èƒ½èµšå¤šå°‘é’±ï¼Œè€Œæ˜¯ä½ èƒ½ç•™ä¸‹å¤šå°‘é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„èšè´¢å¯†ç å°±å››ä¸ªå­—ï¼šè°‹å®šè€ŒååŠ¨ã€‚", warnings: ["ä¸è¦èµšå¤šå°‘èŠ±å¤šå°‘", "ä¸è¦äº‹å¿…èº¬äº²", "ä¸è¦ç›²ç›®æ‰©å¼ ", "ä¸è¦åªç›¯ç€èµšé’±"], task: "è¿™ä¸ªæœˆï¼Œç»™è‡ªå·±åšä¸€ä»½å…¨å¹´çš„è´¢å¯Œè§„åˆ’å’Œæ”¶æ”¯è¡¨ã€‚" },
                        danger: { type: "é¿å‘é¢„è­¦å‹", title: "èšè´¢å¼€æ‚Ÿå¡", heart: "èšè´¢ï¼Œä¸æ˜¯ä½ èƒ½èµšå¤šå°‘é’±ï¼Œè€Œæ˜¯ä½ èƒ½ç•™ä¸‹å¤šå°‘é’±ã€‚\næ–°çš„ä¸€å¹´ï¼Œä½ çš„èšè´¢å¯†ç å°±å››ä¸ªå­—ï¼šè°‹å®šè€ŒååŠ¨ã€‚", warnings: ["ä¸è¦èµšå¤šå°‘èŠ±å¤šå°‘", "ä¸è¦äº‹å¿…èº¬äº²", "ä¸è¦ç›²ç›®æ‰©å¼ ", "ä¸è¦åªç›¯ç€èµšé’±"], task: "è¿™ä¸ªæœˆï¼Œç»™è‡ªå·±åšä¸€ä»½å…¨å¹´çš„è´¢å¯Œè§„åˆ’å’Œæ”¶æ”¯è¡¨ã€‚" }
                    }
                }
            ],
            dailyWisdom: [
                {
                    quote: "ä»Šå¤©åˆ«æ‘¸é±¼ï¼æŠŠé‚£äº‹å„¿å¹²å®Œï¼Œæ™šä¸Šå°±èƒ½å®‰å¿ƒåˆ·æ‰‹æœºäº†ï¼",
                    god: { emoji: "ğŸ†", name: "æ–‡è´¢ç¥æ¯”å¹²", desc: "å®ˆæ­£èšè´¢å°èƒ½æ‰‹" },
                    luckyTime: "è¾°å·³ä¸¤å°æ—¶ï¼ˆ7-11ç‚¹ï¼‰",
                    luckyColor: "çº¢è‰²/é‡‘è‰²",
                    luckyDirection: "å—æ–¹",
                    dos: ["å†™æ–¹æ¡ˆ/æ”¹ç®€å†", "å­¦ä¸ªæ–°æŠ€èƒ½", "ç»™å·¥ä½å¤§æ‰«é™¤"],
                    donts: ["åˆ·çŸ­è§†é¢‘åœä¸ä¸‹æ¥", "è·ŸåŒäº‹æ‹Œå˜´", "å¿ä¸ä½ä¹°æ²¡ç”¨çš„ä¸œè¥¿"]
                },
                {
                    quote: "åˆ«çŠ¹è±«ï¼æƒ³åšä»€ä¹ˆå°±å»åšï¼Œæœ€å·®çš„ç»“æœå°±æ˜¯ä»0å¼€å§‹ï¼",
                    god: { emoji: "âš¡", name: "æ­¦è´¢ç¥å…³å…¬", desc: "ä¹‰è–„äº‘å¤©è®²ä¹‰æ°”" },
                    luckyTime: "åˆç”³ä¸¤å°æ—¶ï¼ˆ11-17ç‚¹ï¼‰",
                    luckyColor: "ç»¿è‰²/è“è‰²",
                    luckyDirection: "ä¸œæ–¹",
                    dos: ["çº¦äººåƒé¥­è°ˆäº‹", "å‹‡æ•¢åšå†³å®š", "ä¸»åŠ¨å‡ºå‡»"],
                    donts: ["çº ç»“åˆ°å¤´ç–¼", "èƒŒååæ§½åˆ«äºº", "All in å†’é™©"]
                },
                {
                    quote: "äººè„‰ä¸æ˜¯æ”’å‡ºæ¥çš„ï¼ä½ å‰å®³ï¼Œäººè„‰è‡ªç„¶å°±æ¥äº†ï¼",
                    god: { emoji: "ğŸ¤", name: "æ–‡è´¢ç¥èŒƒè ¡", desc: "èšå–„æˆè´¢è€å¥½äºº" },
                    luckyTime: "æœªé…‰ä¸¤å°æ—¶ï¼ˆ13-19ç‚¹ï¼‰",
                    luckyColor: "ç´«è‰²/ç™½è‰²",
                    luckyDirection: "ä¸œå—æ–¹",
                    dos: ["ç»™æœ‹å‹å‘ä¸ªæ¶ˆæ¯", "èƒ½å¸®å°±å¸®ä¸€æŠŠ", "å‡ºå»ç¤¾äº¤"],
                    donts: ["å®…ä¸€å¤©ä¸å‡ºé—¨", "å¤ªæŠ é—¨", "æ€»æƒ³å ä¾¿å®œ"]
                },
                {
                    quote: "èµšäº†é’±åˆ«ä¹±èŠ±ï¼å­˜èµ·æ¥ï¼Œçœ‹ç€ä½™é¢å¢é•¿æ¯”å•¥éƒ½é¦™ï¼",
                    god: { emoji: "ğŸ“Š", name: "æ­¦è´¢ç¥èµµå…¬æ˜", desc: "æ‹›è´¢è¿›å®é“å…¬é¸¡" },
                    luckyTime: "æˆŒäº¥ä¸¤å°æ—¶ï¼ˆ19-23ç‚¹ï¼‰",
                    luckyColor: "é»„è‰²/æ£•è‰²",
                    luckyDirection: "è¥¿æ–¹",
                    dos: ["çœ‹çœ‹è´¦æˆ·ä½™é¢", "å¤ç›˜ä»Šå¤©çš„æ”¶æ”¯", "è½¬ä¸€ç¬”å®šæœŸ"],
                    donts: ["æŠ¥å¤æ€§æ¶ˆè´¹", "å¬é£å°±æ˜¯é›¨ä¹±æŠ•èµ„", "å€Ÿé’±ç»™ä¸é è°±çš„äºº"]
                },
                {
                    quote: "æ—©èµ·åŠå°æ—¶ï¼Œä»Šå¤©å°±æ¯”åˆ«äººå¤šèµšäº†åŠå¤©ï¼",
                    god: { emoji: "ğŸš€", name: "äº”è·¯è´¢ç¥", desc: "äº”ç¦ä¸´é—¨é”¦é²¤æœ¬é²¤" },
                    luckyTime: "å¯è¾°ä¸¤å°æ—¶ï¼ˆ5-9ç‚¹ï¼‰",
                    luckyColor: "æ©™è‰²/ç²‰è‰²",
                    luckyDirection: "ä¸œåŒ—æ–¹",
                    dos: ["æ—©èµ·è¿åŠ¨/çœ‹ä¹¦", "åˆ—ä¸ªä»Šæ—¥æ¸…å•", "å¼€å§‹æƒ³äº†å¾ˆä¹…çš„äº‹"],
                    donts: ["èµ–åºŠåˆ°ä¸­åˆ", "ç„¦è™‘åˆ°å•¥ä¹Ÿå¹²ä¸æˆ", "éå¾—å®Œç¾äº†æ‰å¼€å§‹"]
                },
                {
                    quote: "åˆ«èººå¹³ï¼ä½ ä»Šå¤©å·çš„æ‡’ï¼Œæ˜å¤©éƒ½ä¼šå˜æˆè¦è¿˜çš„å€ºï¼",
                    god: { emoji: "ğŸ’", name: "æ–‡è´¢ç¥æ¯”å¹²", desc: "å®ˆæ­£èšè´¢å·ç‹" },
                    luckyTime: "å·³åˆä¸¤å°æ—¶ï¼ˆ9-13ç‚¹ï¼‰",
                    luckyColor: "è—é’è‰²/é‡‘è‰²",
                    luckyDirection: "å—æ–¹",
                    dos: ["æ·±åº¦å·¥ä½œ4å°æ—¶", "å­¦ä¸ªç¡¬æŠ€èƒ½", "è¯»å‡ é¡µä¹¦"],
                    donts: ["å•¥éƒ½æµ…å°è¾„æ­¢", "æ€»æƒ³èµ°æ·å¾„", "æµªè´¹æ—¶é—´åœ¨æ²¡ç”¨çš„äº‹ä¸Š"]
                },
                {
                    quote: "åˆ«æ€¥ï¼æ…¢æ…¢æ¥ï¼Œæ¯”è¾ƒå¿«ï¼Œä¸€æ­¥ä¸€ä¸ªè„šå°æ‰ç¨³ï¼",
                    god: { emoji: "ğŸŒ±", name: "æ­¦è´¢ç¥èµµå…¬æ˜", desc: "æ‹›è´¢è¿›å®ç¨³å¾—ä½" },
                    luckyTime: "è¾°æœªä¸¤å°æ—¶ï¼ˆ7-15ç‚¹ï¼‰",
                    luckyColor: "ç»¿è‰²/åœŸé»„è‰²",
                    luckyDirection: "è¥¿å—æ–¹",
                    dos: ["è¸è¸å®å®åšäº‹", "æ…¢æ…¢ç§¯ç´¯èµ„æº", "æ‰“å¥½åŸºç¡€"],
                    donts: ["æƒ³ä¸€å£åƒæˆèƒ–å­", "ä»Šå¤©åšè¿™ä¸ªæ˜å¤©åšé‚£ä¸ª", "é‡åˆ°å›°éš¾å°±æ”¾å¼ƒ"]
                },
                {
                    quote: "çˆ±ç¬‘çš„äººè¿æ°”ä¸ä¼šå¤ªå·®ï¼ä»Šå¤©è®°å¾—å¤šç¬‘ä¸€ç¬‘ï½",
                    god: { emoji: "ğŸ˜Š", name: "äº”è·¯è´¢ç¥", desc: "äº”ç¦ä¸´é—¨å¼€å¿ƒæœ" },
                    luckyTime: "å…¨å¤©éƒ½å¯ä»¥",
                    luckyColor: "ä½ å–œæ¬¢çš„é¢œè‰²",
                    luckyDirection: "ä½ æƒ³å»çš„æ–¹å‘",
                    dos: ["å¤¸å¤¸è‡ªå·±", "å¤¸å¤¸åˆ«äºº", "åšä¸€ä»¶è®©è‡ªå·±å¼€å¿ƒçš„äº‹"],
                    donts: ["å‚å¤´ä¸§æ°”", "æŠ±æ€¨ä¸ªä¸åœ", "è·Ÿè‡ªå·±è¿‡ä¸å»"]
                }
            ]
        };

        let currentGameState = {};
        let catchGameInterval = null;

        function loadGameData() {
            const saved = localStorage.getItem('fortuneGate');
            if (saved) { gameData = { ...gameData, ...JSON.parse(saved) }; }
        }

        function saveGameData() {
            localStorage.setItem('fortuneGate', JSON.stringify(gameData));
        }

        function hideAllPages() {
            document.querySelectorAll('.main-content > div').forEach(el => el.classList.add('hidden'));
        }

        function showWelcome() {
            hideAllPages();
            document.getElementById('welcome-page').classList.remove('hidden');
        }

        function showMenu() {
            hideAllPages();
            document.getElementById('menu-page').classList.remove('hidden');
        }

        function startGame() {
            gameData.currentGate = 1;
            gameData.gameResults = {};
            saveGameData();
            showGame();
        }

        function continueGame() {
            if (gameData.currentGate > 4) {
                showMenu();
                alert('ğŸ‰ æ­å–œä½ ï¼å››æ‰‡è´¢é—¨å·²ç»å…¨éƒ¨æ‰“å¼€ï¼å»è´¢åº“çœ‹çœ‹ä½ çš„æ”¶è·å§ï½');
            } else {
                showGame();
            }
        }

        function restartGame() {
            if (confirm('ç¡®å®šè¦é‡æ–°å¼€å§‹å—ï¼Ÿå½“å‰è¿›åº¦ä¼šè¢«æ¸…ç©ºã€‚')) {
                gameData.currentGate = 1;
                gameData.gameResults = {};
                gameData.unlockedCards = [];
                saveGameData();
                showGame();
            }
        }

        function showGame() {
            hideAllPages();
            const gate = staticData.gates[gameData.currentGate - 1];
            document.getElementById('gate-title').textContent = `${gate.emoji} ç¬¬${gameData.currentGate}å…³ï¼š${gate.name} - ${gate.god}`;
            const progress = (gameData.currentGate - 1) / 4 * 100;
            document.getElementById('progress-fill').style.width = `${progress}%`;
            
            switch (gate.gameType) {
                case 'sorting':
                    initSortingGame(gate);
                    break;
                case 'catch':
                    initCatchGame(gate);
                    break;
                case 'match':
                    initMatchGame(gate);
                    break;
                case 'choice':
                    initChoiceGame(gate);
                    break;
                case 'allocate':
                    initAllocateGame(gate);
                    break;
            }
            
            document.getElementById('game-page').classList.remove('hidden');
        }

        function initSortingGame(gate) {
            const gameCard = document.getElementById('game-card');
            const data = gate.gameData;
            
            const shuffledItems = [...data.items].sort(() => Math.random() - 0.5);
            
            currentGameState = {
                sortedItems: {},
                items: shuffledItems,
                currentItemIndex: 0,
                score: 0
            };
            
            data.categories.forEach(cat => {
                currentGameState.sortedItems[cat.id] = [];
            });

            renderSortingGame();
        }

        function renderSortingGame() {
            const gate = staticData.gates[gameData.currentGate - 1];
            const data = gate.gameData;
            const gameCard = document.getElementById('game-card');
            
            if (currentGameState.currentItemIndex >= currentGameState.items.length) {
                submitSortingGame();
                return;
            }
            
            const currentItem = currentGameState.items[currentGameState.currentItemIndex];
            const progress = currentGameState.currentItemIndex / currentGameState.items.length * 100;

            let html = `
                <div class="sorting-game">
                    <div class="game-instruction">ç¬¬ ${currentGameState.currentItemIndex + 1}/${currentGameState.items.length} é¢˜<br>è¿™ä¸ªå±äºå“ªä¸€ç±»ï¼Ÿ</div>
                    <div style="text-align: center; margin: 24px 0;">
                        <div style="font-size: 5rem; animation: float 2s ease-in-out infinite;">${currentItem.emoji}</div>
                        <div style="margin-top: 8px; color: var(--text-muted);">${currentItem.name}</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        ${data.categories.map(cat => `
                            <div class="sorting-box" style="cursor: pointer; border-style: solid;" 
                                 onclick="selectCategory('${cat.id}')">
                                <div class="sorting-box-title">${cat.emoji} ${cat.name}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="margin-top: 20px;">
                        <div style="background: rgba(255,255,255,0.3); height: 6px; border-radius: 3px;">
                            <div style="background: linear-gradient(90deg, var(--gold-deep), var(--gold)); height: 100%; width: ${progress}%; border-radius: 3px; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                </div>
            `;
            gameCard.innerHTML = html;
        }

        function selectCategory(categoryId) {
            const gate = staticData.gates[gameData.currentGate - 1];
            const currentItem = currentGameState.items[currentGameState.currentItemIndex];
            
            currentGameState.sortedItems[categoryId].push(currentItem);
            
            if (currentItem.category === categoryId) {
                currentGameState.score += currentItem.weight;
            }
            
            currentGameState.currentItemIndex++;
            
            setTimeout(renderSortingGame, 400);
        }

        function submitSortingGame() {
            const gate = staticData.gates[gameData.currentGate - 1];
            let totalWeight = 0;
            
            gate.gameData.items.forEach(item => {
                totalWeight += item.weight;
            });
            
            const percentage = totalWeight > 0 ? currentGameState.score / totalWeight : 0;
            let resultType;
            if (percentage >= 0.7) resultType = 'good';
            else if (percentage >= 0.4) resultType = 'warning';
            else resultType = 'danger';
            
            gameData.gameResults[gameData.currentGate] = { score: currentGameState.score, percentage, type: resultType };
            finishGame();
        }

        function initCatchGame(gate) {
            const gameCard = document.getElementById('game-card');
            const data = gate.gameData;
            
            currentGameState = {
                score: 0,
                timeLeft: data.duration,
                isPlaying: false,
                targetsCaught: 0
            };

            gameCard.innerHTML = `
                <div class="catch-game">
                    <div class="game-instruction">${data.instruction}</div>
                    <div class="score-display">å¾—åˆ†: <span id="catch-score">0</span> | æ—¶é—´: <span id="catch-time">${data.duration}</span>ç§’</div>
                    <div class="game-area" id="catch-area"></div>
                    <button class="btn btn-primary" id="start-catch-btn" style="margin-top: 16px;" onclick="startCatchGame()">å¼€å§‹æ¸¸æˆ ğŸ®</button>
                </div>
            `;
        }

        function startCatchGame() {
            if (currentGameState.isPlaying) return;
            
            const gate = staticData.gates[gameData.currentGate - 1];
            const data = gate.gameData;
            
            currentGameState.isPlaying = true;
            currentGameState.score = 0;
            currentGameState.timeLeft = data.duration;
            
            document.getElementById('start-catch-btn').style.display = 'none';
            document.getElementById('catch-score').textContent = '0';
            document.getElementById('catch-time').textContent = data.duration;
            
            catchGameInterval = setInterval(() => {
                currentGameState.timeLeft--;
                document.getElementById('catch-time').textContent = currentGameState.timeLeft;
                
                if (currentGameState.timeLeft <= 0) {
                    clearInterval(catchGameInterval);
                    endCatchGame();
                }
            }, 1000);
            
            spawnTarget();
        }

        function spawnTarget() {
            if (!currentGameState.isPlaying) return;
            
            const gate = staticData.gates[gameData.currentGate - 1];
            const data = gate.gameData;
            const area = document.getElementById('catch-area');
            
            const isDistractor = Math.random() < 0.25;
            let target;
            
            if (isDistractor) {
                target = data.distractor;
            } else {
                target = data.targets[Math.floor(Math.random() * data.targets.length)];
            }
            
            const targetEl = document.createElement('div');
            targetEl.className = 'catch-target';
            targetEl.style.fontSize = '3rem';
            targetEl.style.cursor = 'pointer';
            targetEl.style.transition = 'transform 0.1s';
            targetEl.textContent = target.emoji;
            targetEl.style.left = `${Math.random() * 70 + 10}%`;
            targetEl.style.top = `${Math.random() * 70 + 10}%`;
            
            targetEl.onclick = () => {
                targetEl.style.transform = 'scale(1.3)';
                setTimeout(() => targetEl.remove(), 100);
                
                currentGameState.score += target.points;
                if (target.points > 0) currentGameState.targetsCaught++;
                
                document.getElementById('catch-score').textContent = Math.max(0, currentGameState.score);
            };
            
            area.appendChild(targetEl);
            
            setTimeout(() => {
                if (targetEl.parentNode) targetEl.remove();
            }, 1500);
            
            if (currentGameState.isPlaying) {
                setTimeout(spawnTarget, 500 + Math.random() * 500);
            }
        }

        function endCatchGame() {
            currentGameState.isPlaying = false;
            const gate = staticData.gates[gameData.currentGate - 1];
            const maxScore = gate.gameData.duration * 2;
            
            const percentage = Math.max(0, currentGameState.score) / maxScore;
            let resultType;
            if (percentage >= 0.6) resultType = 'good';
            else if (percentage >= 0.3) resultType = 'warning';
            else resultType = 'danger';
            
            gameData.gameResults[gameData.currentGate] = { score: currentGameState.score, percentage, type: resultType };
            finishGame();
        }

        function initMatchGame(gate) {
            const gameCard = document.getElementById('game-card');
            const data = gate.gameData;
            
            let cards = [];
            data.pairs.forEach((pair, idx) => {
                cards.push({ id: `left-${idx}`, text: pair.left, pairId: idx, isLeft: true });
                cards.push({ id: `right-${idx}`, text: pair.right, pairId: idx, isLeft: false });
            });
            
            cards.sort(() => Math.random() - 0.5);
            
            currentGameState = {
                cards,
                selectedCard: null,
                matchedPairs: 0,
                totalPairs: data.pairs.length,
                attempts: 0
            };

            let html = `
                <div class="match-game">
                    <div class="game-instruction">${data.instruction}</div>
                    <div class="match-hint">å·²é…å¯¹: <span id="match-count">0</span>/${data.pairs.length}</div>
                    <div class="match-grid" id="match-grid">
                        ${cards.map((card, idx) => `
                            <div class="match-card" data-index="${idx}" onclick="selectMatchCard(${idx})">
                                <div class="match-card-text">${card.text}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            gameCard.innerHTML = html;
        }

        function selectMatchCard(idx) {
            const card = currentGameState.cards[idx];
            const cardEl = document.querySelectorAll('.match-card')[idx];
            
            if (cardEl.classList.contains('matched')) return;
            
            if (currentGameState.selectedCard === null) {
                currentGameState.selectedCard = idx;
                cardEl.classList.add('selected');
            } else if (currentGameState.selectedCard === idx) {
                currentGameState.selectedCard = null;
                cardEl.classList.remove('selected');
            } else {
                const prevCard = currentGameState.cards[currentGameState.selectedCard];
                const prevCardEl = document.querySelectorAll('.match-card')[currentGameState.selectedCard];
                
                currentGameState.attempts++;
                
                if (card.pairId === prevCard.pairId) {
                    cardEl.classList.add('matched');
                    prevCardEl.classList.add('matched');
                    prevCardEl.classList.remove('selected');
                    currentGameState.matchedPairs++;
                    document.getElementById('match-count').textContent = currentGameState.matchedPairs;
                    
                    if (currentGameState.matchedPairs === currentGameState.totalPairs) {
                        setTimeout(() => {
                            const gate = staticData.gates[gameData.currentGate - 1];
                            const accuracy = currentGameState.totalPairs / currentGameState.attempts;
                            let resultType;
                            if (accuracy >= 0.8) resultType = 'good';
                            else if (accuracy >= 0.5) resultType = 'warning';
                            else resultType = 'danger';
                            
                            gameData.gameResults[gameData.currentGate] = { 
                                score: currentGameState.matchedPairs, 
                                percentage: accuracy, 
                                type: resultType 
                            };
                            finishGame();
                        }, 800);
                    }
                } else {
                    cardEl.classList.add('selected');
                    setTimeout(() => {
                        cardEl.classList.remove('selected');
                        prevCardEl.classList.remove('selected');
                    }, 600);
                }
                currentGameState.selectedCard = null;
            }
        }

        function initAllocateGame(gate) {
            const gameCard = document.getElementById('game-card');
            const data = gate.gameData;
            
            currentGameState = {
                allocations: {}
            };
            
            let remaining = data.total;
            const defaultValue = Math.floor(data.total / data.categories.length);
            
            data.categories.forEach(cat => {
                currentGameState.allocations[cat.id] = defaultValue;
                remaining -= defaultValue;
            });
            
            if (remaining > 0) {
                currentGameState.allocations[data.categories[0].id] += remaining;
            }

            let html = `
                <div class="allocate-game">
                    <div class="game-instruction">${data.instruction}</div>
                    <div class="total-display">æ€»è®¡: <span id="allocate-total">${data.total}</span>ä¸‡</div>
                    <div class="allocate-sliders">
                        ${data.categories.map(cat => `
                            <div class="allocate-item">
                                <div class="allocate-label">
                                    <span>${cat.emoji} ${cat.name}</span>
                                    <span class="allocate-value" id="allocate-${cat.id}">${currentGameState.allocations[cat.id]}</span>
                                </div>
                                <input type="range" 
                                       min="${cat.min}" 
                                       max="${cat.max}" 
                                       value="${currentGameState.allocations[cat.id]}"
                                       data-category="${cat.id}"
                                       oninput="updateAllocation('${cat.id}', this.value)">
                            </div>
                        `).join('')}
                    </div>
                    <button class="btn btn-primary" style="margin-top: 24px;" onclick="submitAllocateGame()">ç¡®è®¤åˆ†é… âœ…</button>
                </div>
            `;
            gameCard.innerHTML = html;
        }

        function updateAllocation(categoryId, value) {
            currentGameState.allocations[categoryId] = parseInt(value);
            document.getElementById(`allocate-${categoryId}`).textContent = value;
            
            const gate = staticData.gates[gameData.currentGate - 1];
            let total = 0;
            gate.gameData.categories.forEach(cat => {
                total += currentGameState.allocations[cat.id];
            });
            document.getElementById('allocate-total').textContent = total;
        }

        function submitAllocateGame() {
            const gate = staticData.gates[gameData.currentGate - 1];
            const data = gate.gameData;
            
            let score = 0;
            
            const saving = currentGameState.allocations.saving || 0;
            const investment = currentGameState.allocations.investment || 0;
            const consumption = currentGameState.allocations.consumption || 0;
            const study = currentGameState.allocations.study || 0;
            
            if (saving >= 25 && saving <= 45) score += 30;
            else if (saving >= 15 && saving <= 55) score += 15;
            
            if (investment >= 20 && investment <= 40) score += 30;
            else if (investment >= 10 && investment <= 50) score += 15;
            
            if (consumption >= 10 && consumption <= 25) score += 20;
            else if (consumption >= 5 && consumption <= 30) score += 10;
            
            if (study >= 8 && study <= 15) score += 20;
            else if (study >= 5 && study <= 20) score += 10;
            
            const percentage = score / 100;
            let resultType;
            if (percentage >= 0.7) resultType = 'good';
            else if (percentage >= 0.4) resultType = 'warning';
            else resultType = 'danger';
            
            gameData.gameResults[gameData.currentGate] = { score, percentage, type: resultType };
            finishGame();
        }

        function initChoiceGame(gate) {
            const gameCard = document.getElementById('game-card');
            const data = gate.gameData;
            
            currentGameState = {
                questions: data.questions,
                currentQuestion: 0,
                score: 0
            };
            
            renderChoiceGame();
        }

        function renderChoiceGame() {
            const gate = staticData.gates[gameData.currentGate - 1];
            const data = gate.gameData;
            const gameCard = document.getElementById('game-card');
            
            if (currentGameState.currentQuestion >= currentGameState.questions.length) {
                submitChoiceGame();
                return;
            }
            
            const q = currentGameState.questions[currentGameState.currentQuestion];
            const progress = currentGameState.currentQuestion / currentGameState.questions.length * 100;
            
            let html = `
                <div class="choice-game">
                    <div class="game-instruction">
                        ç¬¬ ${currentGameState.currentQuestion + 1}/${currentGameState.questions.length} é¢˜<br>${data.instruction}
                    </div>
                    <div style="text-align: center; margin: 24px 0;">
                        <div style="font-size: 4rem; margin-bottom: 12px;">${q.emoji}</div>
                        <div style="font-size: 1.1rem; font-weight: 600; color: var(--text-dark);">${q.question}</div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        ${q.options.map((opt, idx) => `
                            <div class="choice-option" onclick="selectChoice(${idx})">
                                ${opt.text}
                            </div>
                        `).join('')}
                    </div>
                    <div style="margin-top: 20px;">
                        <div style="background: rgba(255,255,255,0.3); height: 6px; border-radius: 3px;">
                            <div style="background: linear-gradient(90deg, var(--gold-deep), var(--gold)); height: 100%; width: ${progress}%; border-radius: 3px; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                </div>
            `;
            gameCard.innerHTML = html;
        }

        function selectChoice(optionIndex) {
            const q = currentGameState.questions[currentGameState.currentQuestion];
            const opt = q.options[optionIndex];
            
            if (opt.value === 'good') {
                currentGameState.score++;
            }
            
            currentGameState.currentQuestion++;
            setTimeout(renderChoiceGame, 400);
        }

        function submitChoiceGame() {
            const gate = staticData.gates[gameData.currentGate - 1];
            const total = currentGameState.questions.length;
            const percentage = currentGameState.score / total;
            
            let resultType;
            if (percentage >= 0.7) resultType = 'good';
            else if (percentage >= 0.4) resultType = 'warning';
            else resultType = 'danger';
            
            gameData.gameResults[gameData.currentGate] = { 
                score: currentGameState.score, 
                percentage, 
                type: resultType 
            };
            finishGame();
        }

        function finishGame() {
            const gate = staticData.gates[gameData.currentGate - 1];
            const result = gameData.gameResults[gameData.currentGate];
            const card = gate.cards[result.type];
            
            if (!gameData.unlockedCards.includes(gameData.currentGate)) {
                gameData.unlockedCards.push(gameData.currentGate);
            }
            saveGameData();
            
            hideAllPages();
            const page = document.getElementById('result-page');
            const resultCard = document.getElementById('result-card');
            let warningsHtml = '<ul class="warnings-list">';
            card.warnings.forEach(w => warningsHtml += `<li>${w}</li>`);
            warningsHtml += '</ul>';
            resultCard.innerHTML = `
                <div class="card-type">ğŸ† ${card.type}</div>
                <div class="card-title">${card.title}</div>
                <div class="section">
                    <div class="section-title">ğŸ“œ è´¢ç¥çœŸä¼ </div>
                    <div class="section-content" style="white-space: pre-line;">${card.heart}</div>
                </div>
                <div class="section">
                    <div class="section-title">âš ï¸ é¿å‘æé†’</div>
                    <div class="section-content">${warningsHtml}</div>
                </div>
                <div class="section">
                    <div class="section-title">âœ… æ–°å¹´å°ä»»åŠ¡</div>
                    <div class="task-box">${card.task}</div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="generatePoster()">ç”Ÿæˆæµ·æŠ¥ ğŸ“¸</button>
                    ${gameData.currentGate < 4 ? '<button class="btn btn-primary" onclick="nextGate()">å¼€å¯ä¸‹ä¸€æ‰‡è´¢é—¨ ğŸšª</button>' : '<button class="btn btn-primary" onclick="showTreasury()">æŸ¥çœ‹è´¢åº“ ğŸ“¦</button>'}
                </div>
                <button class="btn btn-secondary" onclick="showMenu()" style="margin-top: 12px;">è¿”å›èœå•</button>
            `;
            page.classList.remove('hidden');
        }

        function nextGate() {
            gameData.currentGate++;
            saveGameData();
            showGame();
        }

        function showTreasury() {
            hideAllPages();
            const page = document.getElementById('treasury-page');
            const grid = document.getElementById('treasury-grid');
            let html = '';
            staticData.gates.forEach(gate => {
                const unlocked = gameData.unlockedCards.includes(gate.id);
                html += `
                    <div class="treasury-item ${unlocked ? '' : 'locked'}" onclick="${unlocked ? `showCardDetail(${gate.id})` : ''}">
                        <span class="treasury-emoji">${unlocked ? gate.emoji : 'ğŸ”’'}</span>
                        <div class="treasury-name">${gate.name}</div>
                    </div>
                `;
            });
            grid.innerHTML = html;
            page.classList.remove('hidden');
        }

        function showCardDetail(gateId) {
            gameData.currentGate = gateId;
            if (!gameData.gameResults[gateId]) {
                gameData.gameResults[gateId] = { type: 'good' };
            }
            finishGame();
        }

        function showDailyWisdom() {
            hideAllPages();
            const today = new Date().toDateString();
            if (gameData.dailyWisdomDate !== today || 
                gameData.dailyWisdomIndex === null || 
                gameData.dailyWisdomIndex >= staticData.dailyWisdom.length) {
                gameData.dailyWisdomDate = today;
                gameData.dailyWisdomIndex = Math.floor(Math.random() * staticData.dailyWisdom.length);
                saveGameData();
            }
            const wisdom = staticData.dailyWisdom[gameData.dailyWisdomIndex];
            
            const dateObj = new Date();
            const dateStr = `${dateObj.getFullYear()}å¹´${dateObj.getMonth() + 1}æœˆ${dateObj.getDate()}æ—¥`;
            document.getElementById('wisdom-date').textContent = dateStr;
            
            document.getElementById('wisdom-god').innerHTML = `
                <div class="wisdom-god-emoji">${wisdom.god.emoji}</div>
                <div class="wisdom-god-name">${wisdom.god.name}</div>
                <div class="wisdom-god-desc">${wisdom.god.desc}</div>
            `;
            
            document.getElementById('wisdom-lucky-time').innerHTML = `
                <div class="wisdom-lucky-title">â° ä»Šæ—¥å‰æ—¶</div>
                <div class="wisdom-lucky-content">
                    <div>å‰æ—¶ï¼š${wisdom.luckyTime}</div>
                    <div>å¹¸è¿è‰²ï¼š${wisdom.luckyColor}</div>
                    <div>è´¢ä½æ–¹å‘ï¼š${wisdom.luckyDirection}</div>
                </div>
            `;
            
            document.getElementById('wisdom-dos').innerHTML = `
                <div class="wisdom-do-item wisdom-do-good">
                    <div class="wisdom-do-title">âœ… ä»Šæ—¥å®œåš</div>
                    <div class="wisdom-do-list">
                        ${wisdom.dos.map(item => `â€¢ ${item}`).join('<br>')}
                    </div>
                </div>
                <div class="wisdom-do-item wisdom-do-bad">
                    <div class="wisdom-do-title">âŒ ä»Šæ—¥å¿Œåš</div>
                    <div class="wisdom-do-list">
                        ${wisdom.donts.map(item => `â€¢ ${item}`).join('<br>')}
                    </div>
                </div>
            `;
            
            document.getElementById('daily-wisdom-text').textContent = wisdom.quote;
            document.getElementById('wisdom-page').classList.remove('hidden');
        }

        function generatePoster() {
            const gate = staticData.gates[gameData.currentGate - 1];
            const result = gameData.gameResults[gameData.currentGate] || { type: 'good' };
            const card = gate.cards[result.type];
            document.getElementById('poster-content').innerHTML = `
                <div style="font-weight: 700; font-size: 1.3rem; margin-bottom: 12px; color: #C41E3A; letter-spacing: 1px;">${card.title}</div>
                <div style="margin-bottom: 18px; color: #666; font-size: 0.95rem;">${card.type}</div>
                <div style="line-height: 2; font-size: 1rem; color: #2D1B0E;">${card.heart}</div>
            `;
            document.getElementById('poster-container').classList.remove('hidden');
            
            const loadingEl = document.createElement('div');
            loadingEl.id = 'poster-loading';
            loadingEl.style.cssText = 'position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.8);color:white;padding:20px 30px;border-radius:12px;font-size:1rem;z-index:100;';
            loadingEl.textContent = 'ğŸ¨ æ­£åœ¨ç”Ÿæˆæµ·æŠ¥...';
            document.getElementById('poster-container').appendChild(loadingEl);
            
            setTimeout(() => {
                html2canvas(document.getElementById('poster'), {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: '#C41E3A'
                }).then(canvas => {
                    const loading = document.getElementById('poster-loading');
                    if (loading) loading.remove();
                    
                    const link = document.createElement('a');
                    link.download = 'fortune-gate.png';
                    link.href = canvas.toDataURL();
                    link.click();
                    document.getElementById('poster-container').classList.add('hidden');
                }).catch(err => {
                    const loading = document.getElementById('poster-loading');
                    if (loading) loading.remove();
                    
                    console.error('æµ·æŠ¥ç”Ÿæˆå¤±è´¥:', err);
                    document.getElementById('poster-container').classList.add('hidden');
                    alert('æµ·æŠ¥ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åå†è¯•');
                });
            }, 600);
        }

        loadGameData();
        
        function initWelcomeWisdom() {
            const today = new Date().toDateString();
            if (gameData.dailyWisdomDate !== today || 
                gameData.dailyWisdomIndex === null || 
                gameData.dailyWisdomIndex >= staticData.dailyWisdom.length) {
                gameData.dailyWisdomDate = today;
                gameData.dailyWisdomIndex = Math.floor(Math.random() * staticData.dailyWisdom.length);
                saveGameData();
            }
            const wisdom = staticData.dailyWisdom[gameData.dailyWisdomIndex];
            const dateObj = new Date();
            const dateStr = `${dateObj.getFullYear()}å¹´${dateObj.getMonth() + 1}æœˆ${dateObj.getDate()}æ—¥`;
            
            document.getElementById('welcome-wisdom-date').textContent = dateStr;
            document.getElementById('welcome-wisdom-god').innerHTML = `
                <div class="dw-god-emoji">${wisdom.god.emoji}</div>
                <div class="dw-god-name">${wisdom.god.name}</div>
            `;
            document.getElementById('welcome-wisdom-quote').textContent = wisdom.quote;
        }
        
        initWelcomeWisdom();

        document.getElementById('poster-container').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
            }
        });

        document.getElementById('wisdom-poster-container').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
            }
        });

        function generateWisdomPoster() {
            const today = new Date().toDateString();
            if (gameData.dailyWisdomDate !== today || 
                gameData.dailyWisdomIndex === null || 
                gameData.dailyWisdomIndex >= staticData.dailyWisdom.length) {
                gameData.dailyWisdomDate = today;
                gameData.dailyWisdomIndex = Math.floor(Math.random() * staticData.dailyWisdom.length);
                saveGameData();
            }
            const wisdom = staticData.dailyWisdom[gameData.dailyWisdomIndex];
            const dateObj = new Date();
            const weekDays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            const dateStr = `${dateObj.getFullYear()}å¹´${dateObj.getMonth() + 1}æœˆ${dateObj.getDate()}æ—¥ ${weekDays[dateObj.getDay()]}`;
            
            document.getElementById('wisdom-poster-content').innerHTML = `
                <div style="text-align: center; padding: 8px 0 20px 0;">
                    <div style="font-size: 0.9rem; color: #888; margin-bottom: 4px;">${dateStr}</div>
                    <div style="font-size: 1.1rem; font-weight: 800; color: #C41E3A; letter-spacing: 3px;">ä»Šæ—¥è´¢ç¥å¼€ç¤º</div>
                </div>
                
                <div style="display: flex; align-items: center; justify-content: center; gap: 12px; background: linear-gradient(135deg, #FFF5E6 0%, #FFEED6 100%); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                    <div style="font-size: 3.5rem;">${wisdom.god.emoji}</div>
                    <div style="text-align: left;">
                        <div style="font-weight: 800; font-size: 1.2rem; color: #2D1B0E;">${wisdom.god.name}</div>
                        <div style="font-size: 0.9rem; color: #C41E3A;">${wisdom.god.desc}</div>
                    </div>
                </div>
                
                <div style="background: linear-gradient(180deg, #FFF9F0 0%, #FFFFFF 100%); border-left: 4px solid #C41E3A; border-radius: 8px; padding: 16px 16px 16px 14px; margin-bottom: 16px;">
                    <div style="font-size: 1.1rem; font-weight: 600; line-height: 1.8; color: #2D1B0E;">${wisdom.quote}</div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px;">
                    <div style="background: #FFF5E6; border-radius: 8px; padding: 12px; text-align: center;">
                        <div style="font-size: 0.85rem; color: #888; margin-bottom: 4px;">â° å‰æ—¶</div>
                        <div style="font-size: 0.95rem; font-weight: 600; color: #2D1B0E;">${wisdom.luckyTime}</div>
                    </div>
                    <div style="background: #FFF5E6; border-radius: 8px; padding: 12px; text-align: center;">
                        <div style="font-size: 0.85rem; color: #888; margin-bottom: 4px;">ğŸ¨ å¹¸è¿è‰²</div>
                        <div style="font-size: 0.95rem; font-weight: 600; color: #2D1B0E;">${wisdom.luckyColor}</div>
                    </div>
                </div>
                
                <div style="background: #FFF5E6; border-radius: 8px; padding: 12px; text-align: center; margin-bottom: 16px;">
                    <div style="font-size: 0.85rem; color: #888; margin-bottom: 4px;">ğŸ§­ è´¢ä½</div>
                    <div style="font-size: 0.95rem; font-weight: 600; color: #2D1B0E;">${wisdom.luckyDirection}</div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div style="background: #E8F5E9; border-radius: 8px; padding: 12px;">
                        <div style="font-size: 0.85rem; font-weight: 700; color: #2E7D32; margin-bottom: 8px;">âœ… ä»Šæ—¥å®œåš</div>
                        <div style="font-size: 0.85rem; color: #2D1B0E; line-height: 1.7;">
                            ${wisdom.dos.map((item, i) => `<div style="margin-bottom: 4px;">â€¢ ${item}</div>`).join('')}
                        </div>
                    </div>
                    <div style="background: #FFEBEE; border-radius: 8px; padding: 12px;">
                        <div style="font-size: 0.85rem; font-weight: 700; color: #C62828; margin-bottom: 8px;">âŒ ä»Šæ—¥å¿Œåš</div>
                        <div style="font-size: 0.85rem; color: #2D1B0E; line-height: 1.7;">
                            ${wisdom.donts.map((item, i) => `<div style="margin-bottom: 4px;">â€¢ ${item}</div>`).join('')}
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('wisdom-poster-container').classList.remove('hidden');
            
            const loadingEl = document.createElement('div');
            loadingEl.id = 'wisdom-poster-loading';
            loadingEl.style.cssText = 'position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.8);color:white;padding:20px 30px;border-radius:12px;font-size:1rem;z-index:100;';
            loadingEl.textContent = 'ğŸ¨ æ­£åœ¨ç”Ÿæˆæµ·æŠ¥...';
            document.getElementById('wisdom-poster-container').appendChild(loadingEl);
            
            setTimeout(() => {
                html2canvas(document.getElementById('wisdom-poster'), {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: '#C41E3A'
                }).then(canvas => {
                    const loading = document.getElementById('wisdom-poster-loading');
                    if (loading) loading.remove();
                    
                    const link = document.createElement('a');
                    link.download = 'daily-wisdom.png';
                    link.href = canvas.toDataURL();
                    link.click();
                    document.getElementById('wisdom-poster-container').classList.add('hidden');
                }).catch(err => {
                    const loading = document.getElementById('wisdom-poster-loading');
                    if (loading) loading.remove();
                    
                    console.error('æµ·æŠ¥ç”Ÿæˆå¤±è´¥:', err);
                    document.getElementById('wisdom-poster-container').classList.add('hidden');
                    alert('æµ·æŠ¥ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åå†è¯•');
                });
            }, 600);
        }
    </script>
</body>
</html>